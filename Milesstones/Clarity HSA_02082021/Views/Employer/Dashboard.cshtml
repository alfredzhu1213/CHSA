
@{
    ViewBag.Title = "Dashboard";

    var user = (Clarity_HSA.Models.User)@ViewData["user"];
}

<div class="col-md-6">
    <a href="#" onclick="$('#quadrant_1_select').show();"><span class="glyphicon glyphicon-cog" aria-hidden="true" style="position:absolute; top:0; right:0;"></span></a>
    <form id="quadrant_1_select" action="/Employer/DashboardUpdate" method="post" style="display:none;">
        <input type="hidden" name="quadrant_number" value="1" />
        <select name="quadrant_chart" class="form_control">
            <option value="0">None</option>
            @if (user.dashboard_config.quadrant_1 == "1")
            {
                <option value="1" selected="selected">Charges By Employer</option>
            }
            else
            {
                <option value="1">Charges By Employer</option>
            }
            @if (user.dashboard_config.quadrant_1 == "2")
            {
                <option value="2" selected="selected">Repayments By Employer</option>
            }
            else
            {
                <option value="2">Repayments By Employer</option>
            }
            @if (user.dashboard_config.quadrant_1 == "3")
            {
                <option value="3" selected="selected">Repayments vs Charges</option>
            }
            else
            {
                <option value="3">Repayments vs Charges</option>
            }
            @if (user.dashboard_config.quadrant_1 == "4")
            {
                <option value="4" selected="selected">Employee Charge Counts</option>
            }
            else
            {
                <option value="4">Employee Charge Counts</option>
            }
            @if (user.dashboard_config.quadrant_1 == "5")
            {
                <option value="5" selected="selected">Repayments By Month</option>
            }
            else
            {
                <option value="5">Repayments By Month</option>
            }
        </select>
        <input type="submit" class="btn btn-sm btn-primary" value="Update" />
    </form>
    <div id="container1" class="chart_@user.dashboard_config.quadrant_1" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto"></div>
</div>

<div class="col-md-6">
    <a href="#" onclick="$('#quadrant_2_select').show();"><span class="glyphicon glyphicon-cog" aria-hidden="true" style="position:absolute; top:0; right:0;"></span></a>
    <form id="quadrant_2_select" action="/Employer/DashboardUpdate" method="post" style="display:none;">
        <input type="hidden" name="quadrant_number" value="2" />
        <select name="quadrant_chart" class="form_control">
            <option value="0">None</option>
            @if (user.dashboard_config.quadrant_2 == "1")
            {
                <option value="1" selected="selected">Charges By Employer</option>
            }
            else
            {
                <option value="1">Charges By Employer</option>
            }
            @if (user.dashboard_config.quadrant_2 == "2")
            {
                <option value="2" selected="selected">Repayments By Employer</option>
            }
            else
            {
                <option value="2">Repayments By Employer</option>
            }
            @if (user.dashboard_config.quadrant_2 == "3")
            {
                <option value="3" selected="selected">Repayments vs Charges</option>
            }
            else
            {
                <option value="3">Repayments vs Charges</option>
            }
            @if (user.dashboard_config.quadrant_2 == "4")
            {
                <option value="4" selected="selected">Employee Charge Counts</option>
            }
            else
            {
                <option value="4">Employee Charge Counts</option>
            }
            @if (user.dashboard_config.quadrant_2 == "5")
            {
                <option value="5" selected="selected">Repayments By Month</option>
            }
            else
            {
                <option value="5">Repayments By Month</option>
            }
        </select>
        <input type="submit" class="btn btn-sm btn-primary" value="Update" />
    </form>
    <div id="container2" class="chart_@user.dashboard_config.quadrant_2" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto"></div>
</div>

<div style="clear:both;"></div>
<br /><br />

<div class="col-md-6">
    <a href="#" onclick="$('#quadrant_3_select').show();"><span class="glyphicon glyphicon-cog" aria-hidden="true" style="position:absolute; top:0; right:0;"></span></a>
    <form id="quadrant_3_select" action="/Employer/DashboardUpdate" method="post" style="display:none;">
        <input type="hidden" name="quadrant_number" value="3" />
        <select name="quadrant_chart" class="form_control">
            <option value="0">None</option>
            @if (user.dashboard_config.quadrant_3 == "1")
            {
                <option value="1" selected="selected">Charges By Employer</option>
            }
            else
            {
                <option value="1">Charges By Employer</option>
            }
            @if (user.dashboard_config.quadrant_3 == "2")
            {
                <option value="2" selected="selected">Repayments By Employer</option>
            }
            else
            {
                <option value="2">Repayments By Employer</option>
            }
            @if (user.dashboard_config.quadrant_3 == "3")
            {
                <option value="3" selected="selected">Repayments vs Charges</option>
            }
            else
            {
                <option value="3">Repayments vs Charges</option>
            }
            @if (user.dashboard_config.quadrant_3 == "4")
            {
                <option value="4" selected="selected">Employee Charge Counts</option>
            }
            else
            {
                <option value="4">Employee Charge Counts</option>
            }
            @if (user.dashboard_config.quadrant_3 == "5")
            {
                <option value="5" selected="selected">Repayments By Month</option>
            }
            else
            {
                <option value="5">Repayments By Month</option>
            }
        </select>
        <input type="submit" class="btn btn-sm btn-primary" value="Update" />
    </form>
    <div id="container3" class="chart_@user.dashboard_config.quadrant_3" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto"></div>
</div>

<div class="col-md-6">
    <a href="#" onclick="$('#quadrant_4_select').show();"><span class="glyphicon glyphicon-cog" aria-hidden="true" style="position:absolute; top:0; right:0;"></span></a>
    <form id="quadrant_4_select" action="/Employer/DashboardUpdate" method="post" style="display:none;">
        <input type="hidden" name="quadrant_number" value="4" />
        <select name="quadrant_chart" class="form_control">
            <option value="0">None</option>
            @if (user.dashboard_config.quadrant_4 == "1")
            {
                <option value="1" selected="selected">Charges By Employer</option>
            }
            else
            {
                <option value="1">Charges By Employer</option>
            }
            @if (user.dashboard_config.quadrant_4 == "2")
            {
                <option value="2" selected="selected">Repayments By Employer</option>
            }
            else
            {
                <option value="2">Repayments By Employer</option>
            }
            @if (user.dashboard_config.quadrant_4 == "3")
            {
                <option value="3" selected="selected">Repayments vs Charges</option>
            }
            else
            {
                <option value="3">Repayments vs Charges</option>
            }
            @if (user.dashboard_config.quadrant_4 == "4")
            {
                <option value="4" selected="selected">Employee Charge Counts</option>
            }
            else
            {
                <option value="4">Employee Charge Counts</option>
            }
            @if (user.dashboard_config.quadrant_4 == "5")
            {
                <option value="5" selected="selected">Repayments By Month</option>
            }
            else
            {
                <option value="5">Repayments By Month</option>
            }
        </select>
        <input type="submit" class="btn btn-sm btn-primary" value="Update" />
    </form>
    <div id="container4" class="chart_@user.dashboard_config.quadrant_4" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto"></div>
</div>

<script type="text/javascript">

    $(document).ready(function () {

        var containers = new Array();
        containers.push("@user.dashboard_config.quadrant_1");
        containers.push("@user.dashboard_config.quadrant_2");
        containers.push("@user.dashboard_config.quadrant_3");
        containers.push("@user.dashboard_config.quadrant_4");

        for (var i = 0; i < containers.length; i++)
        {
            if (containers[i] == "1")
            {
                Highcharts.chart('container' + (i + 1),
                {
                    chart: {
                        type: 'bar'
                    },
                    title: {
                        text: 'Charges By Employer'
                    },
                    subtitle: {
                        text: ''
                    },
                    xAxis: {
                        categories: @Html.Raw(Json.Encode(ViewData["loanBalancesByEmployer_Employers"])),
                        title: {
                            text: null
                        }
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Balance ($)',
                            align: 'high'
                        },
                        labels: {
                            overflow: 'justify'
                        }
                    },
                    tooltip: {
                        valuePrefix: '$',
                        valueSuffix: ''
                    },
                    plotOptions: {
                        bar: {
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    legend: {
                        layout: 'vertical',
                        align: 'right',
                        verticalAlign: 'top',
                        x: -40,
                        y: 80,
                        floating: true,
                        borderWidth: 1,
                        backgroundColor: ((Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF'),
                        shadow: true
                    },
                    credits: {
                        enabled: false
                    },
                    series: [{
                        name: 'Advance Balances',
                        data: @Html.Raw(Json.Encode(ViewData["loanBalancesByEmployer_Balances"])),
                    }]
                });
            }
            else if (containers[i] == "2")
            {
                Highcharts.chart('container' + (i + 1),
                {
                    chart: {
                        type: 'bar'
                    },
                    title: {
                        text: 'Repayments By Employer'
                    },
                    subtitle: {
                        text: ''
                    },
                    xAxis: {
                        categories: @Html.Raw(Json.Encode(ViewData["monthlyPaymentsByEmployer_Employers"])),
                        title: {
                            text: null
                        }
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Monthly Payments ($)',
                            align: 'high'
                        },
                        labels: {
                            overflow: 'justify'
                        }
                    },
                    tooltip: {
                        valuePrefix: '$',
                        valueSuffix: ''
                    },
                    plotOptions: {
                        bar: {
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    legend: {
                        layout: 'vertical',
                        align: 'right',
                        verticalAlign: 'top',
                        x: -40,
                        y: 80,
                        floating: true,
                        borderWidth: 1,
                        backgroundColor: ((Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF'),
                        shadow: true
                    },
                    credits: {
                        enabled: false
                    },
                    series: [{
                        name: 'Monthly Payments',
                        data: @Html.Raw(Json.Encode(ViewData["monthlyPaymentsByEmployer_Payments"])),
                    }]
                });
            }
            else if (containers[i] == "3")
            {
                Highcharts.chart('container' + (i + 1), {
                    chart: {
                        plotBackgroundColor: null,
                        plotBorderWidth: null,
                        plotShadow: false,
                        type: 'pie'
                    },
                    title: {
                        text: 'Repayments vs Charges'
                    },
                    tooltip: {
                        pointFormat: '{series.name}: <b>${point.y:.2f}</b>'
                    },
                    plotOptions: {
                        pie: {
                            allowPointSelect: true,
                            cursor: 'pointer',
                            dataLabels: {
                                enabled: false
                            },
                            showInLegend: true
                        }
                    },
                    series: [{
                        name: 'Balance',
                        colorByPoint: true,
                        data: [
                        {
                            name: 'Paid',
                            y: @ViewData["paidVsOutstandingBalances_Paid"],
                        },
                        {
                            name: 'Outstanding',
                            y: @ViewData["paidVsOutstandingBalances_Outstanding"],
                            sliced: true,
                            selected: true
                        }]
                    }]
                });
            }
            else if (containers[i] == "4")
            {
                Highcharts.chart('container' + (i + 1),
                {
                    chart: {
                        type: 'bar'
                    },
                    title: {
                        text: 'Employee Charge Counts'
                    },
                    subtitle: {
                        text: ''
                    },
                    xAxis: {
                        categories: ["0", "1", "2", "3", "4", "5+"],
                        title: {
                            text: null
                        }
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Advance Count',
                            align: 'high'
                        },
                        labels: {
                            overflow: 'justify'
                        }
                    },
                    tooltip: {
                        valuePrefix: '$',
                        valueSuffix: ''
                    },
                    plotOptions: {
                        bar: {
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    credits: {
                        enabled: false
                    },
                    series: [{
                        name: 'Advance Count',
                        data: @Html.Raw(Json.Encode(ViewData["employeeLoanCounts"])),
                    }]
                });
            }
            else if (containers[i] == "5")
            {
                Highcharts.chart('container' + (i + 1),
                {
                    title:
                    {
                        text: 'Repayments By Month'
                    },
                    subtitle:
                    {
                        text: ''
                    },
                    yAxis:
                    {
                        title:
                        {
                            text: 'Payments ($)'
                        }
                    },
                    xAxis:
                    {
                        categories: @Html.Raw(Json.Encode(ViewData["paymentsByMonth_Months"])),
                    },
                    legend:
                    {
                        layout: 'vertical',
                        align: 'right',
                        verticalAlign: 'middle'
                    },
                    series: 
                    [{
                        name: 'Payments',
                        data: @Html.Raw(Json.Encode(ViewData["paymentsByMonth_Payments"])),
                    }]

                });
            }
        }
    });

</script>